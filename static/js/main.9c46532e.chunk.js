(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{269:function(e,t,n){},281:function(e,t){},282:function(e,t){},290:function(e,t){},296:function(e,t,n){},298:function(e,t,n){"use strict";n.r(t);var c=n(13),r=n.n(c),a=n(224),s=n.n(a),o=(n(269),n(57)),l=n(6),i=n(37),u=n(104),b=n(14);function j(e){var t=e.x,n=e.y;return Object(b.jsx)("div",{className:"ball",style:{top:"".concat(n,"%"),left:"".concat(t,"%")}})}var p=n(9),d=n.n(p),f=n(12);function m(){return(m=Object(f.a)(d.a.mark((function e(t,n){var c,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://pokeapi.co/api/v2/pokemon/".concat(t));case 3:return c=e.sent,e.next=6,c.json();case 6:r=e.sent,function(e){return"object"===typeof e&&null!==e&&"name"in e&&"height"in e&&"weight"in e&&"base_experience"in e}(r)&&n({name:r.name,height:r.height,weight:r.weight,base_experience:r.base_experience,sprites:r.sprites}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}var h=function(e){var t=Object(c.useState)(!0),n=Object(l.a)(t,2),r=n[0],a=n[1],s=Object(c.useState)(),o=Object(l.a)(s,2),i=o[0],u=o[1];return Object(c.useEffect)((function(){var t=!1;return e&&(a(!0),function(e,t){m.apply(this,arguments)}(e,(function(e){t||(u(e),a(!1))}))),function(){t=!0}}),[e]),{isLoading:r,pokemon:i}},O=n(150);function v(e){var t=e.y,n=e.pokemonName,c=e.playerCardType,r=h(n),a=r.isLoading,s=r.pokemon;return a||!s?Object(b.jsx)("div",{className:"".concat(c,"-card"),style:{top:"".concat(t,"%")},children:Object(b.jsx)(O.BallSpinner,{size:70,color:"#6c5b7b"})}):Object(b.jsx)("div",{className:"".concat(c,"-card"),style:{top:"".concat(t,"%")},children:Object(b.jsx)("img",{className:"player-card-image",src:s.sprites.other.dream_world.front_default})})}function x(e){var t=e.firstPlayer,n=e.secondPlayer,c=e.firstPlayerScore,r=e.secondPlayerScore;return Object(b.jsxs)("div",{className:"score",children:[Object(b.jsxs)("span",{className:"first-player-score",children:[X(t),": ",c]}),Object(b.jsxs)("span",{className:"second-player-score",children:[X(n),": ",r]})]})}function y(e){var t=e.winner;return""===t?Object(b.jsx)("div",{className:"modal",children:Object(b.jsxs)("div",{className:"modal_content",children:[Object(b.jsx)("h3",{className:"modal-headers",children:'Press "W" "S" buttons to move the left pokemon'}),Object(b.jsx)("h3",{className:"modal-headers",children:'And "O" "L" buttons to move the right pokemon'}),Object(b.jsx)("h3",{className:"modal-headers",children:"Or move your hands to control both pokemons :-)"})]})}):Object(b.jsx)("div",{className:"modal",children:Object(b.jsxs)("div",{className:"modal_content",children:[Object(b.jsx)("h1",{className:"modal-headers",children:"Game over"}),Object(b.jsxs)("h2",{className:"modal-headers",children:[X(t)," win"]}),Object(b.jsx)("p",{children:'Press "W" "S" buttons to move the left pokemon'}),Object(b.jsx)("p",{children:'And "O" "L" buttons to move the left pokemon'}),Object(b.jsx)("p",{children:"Or move your hands to move both pokemons :-)"})]})})}var k=n(157),S=(n(297),k.a.MoveNet),g={modelType:k.c.modelType.SINGLEPOSE_LIGHTNING};function N(e){var t=Math.floor((e-50)/300*(100-2*E));return t<E?E:t>100-E?100-E:t}function w(e){var t=e.onSetPlayer1Coord,n=e.onSetPlayer2Coord,r=Object(c.useState)(null),a=Object(l.a)(r,2),s=a[0],o=a[1],i=Object(c.useRef)(null),u=Object(c.useState)(null),j=Object(l.a)(u,2),p=j[0],m=j[1],h=Object(c.useState)(!0),O=Object(l.a)(h,2),v=O[0],x=O[1];return Object(c.useEffect)((function(){var e=i.current;if(s&&e){e.srcObject=s,e.play();var c=setInterval((function(){!function(e){r.apply(this,arguments)}(e)}),100);return function(){clearInterval(c)}}function r(){return(r=Object(f.a)(d.a.mark((function e(c){var r,a,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,p.estimatePoses(c,{maxPoses:1,flipHorizontal:!1});case 4:0!==(r=e.sent).length&&(a=r[0].keypoints[9].y,s=r[0].keypoints[10].y,t(N(a)),n(N(s)));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}),[p,t,n,s]),Object(c.useEffect)((function(){return function(){return null===p||void 0===p?void 0:p.dispose()}}),[p]),Object(c.useEffect)((function(){return function(){return null===s||void 0===s?void 0:s.getTracks().forEach((function(e){return e.stop()}))}}),[s]),Object(c.useEffect)((function(){function e(){return(e=Object(f.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=o,e.next=4,navigator.mediaDevices.getUserMedia({video:!0});case 4:e.t1=e.sent,(0,e.t0)(e.t1),e.next=11;break;case 8:e.prev=8,e.t2=e.catch(0),console.log(e.t2);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function t(){return(t=Object(f.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=m,e.next=4,k.b(S,g);case 4:e.t1=e.sent,(0,e.t0)(e.t1),e.next=11;break;case 8:e.prev=8,e.t2=e.catch(0),console.log(e.t2);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),function(){t.apply(this,arguments)}()}),[]),Object(b.jsxs)("div",{children:[Object(b.jsxs)("label",{className:"label-camera",children:["Show camera:",Object(b.jsx)("input",{type:"checkbox",checked:v,onClick:function(){return x(!v)}})]}),Object(b.jsx)("video",{muted:!0,autoPlay:!0,className:"camera ".concat(v?"":"display-none"),ref:i})]})}var P={ballX:50,ballY:50,ballStepX:_([-2,2]),ballStepY:_([-1,1])},C={firstPlayerScore:0,secondPlayerScore:0},E=12,I=E+4;function L(e){return e-E>0?e-2:e}function T(e){return e+E<100?e+2:e}function _(e){return e[Math.floor(Math.random()*e.length)]}function X(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Y(e){var t=e.pokemonOne,n=e.pokemonTwo,r=Object(c.useState)(P),a=Object(l.a)(r,2),s=a[0],p=a[1],d=Object(c.useState)(C),f=Object(l.a)(d,2),m=f[0],h=f[1],O=Object(c.useState)(50),k=Object(l.a)(O,2),S=k[0],g=k[1],N=Object(c.useState)(50),E=Object(l.a)(N,2),X=E[0],Y=E[1],M=Object(c.useState)(!1),G=Object(l.a)(M,2),A=G[0],B=G[1],W=Object(c.useState)(!1),F=Object(l.a)(W,2),H=F[0],z=F[1],D=Object(c.useState)(),J=Object(l.a)(D,2),R=J[0],U=J[1],q=Object(c.useState)(!0),K=Object(l.a)(q,2),Q=K[0],V=K[1];return Object(c.useEffect)((function(){var e=null,t=null,n=function(n){n&&!["w","W","s","S","\u0426","\u0446","\u0456","\u0406","\u042b","\u044b"].includes(n.key)||(e&&clearInterval(e),e=null),n&&!["o","O","l","L","\u0449","\u0429","\u0434","\u0414"].includes(n.key)||(t&&clearInterval(t),t=null)},c=function(n){["w","W","\u0426","\u0446"].includes(n.key)?e=e||setInterval((function(){g(L)}),15):["s","S","\u042b","\u044b","\u0406","\u0456"].includes(n.key)?e=e||setInterval((function(){g(T)}),15):["O","o","\u0429","\u0449"].includes(n.key)?t=t||setInterval((function(){Y(L)}),15):["L","l","\u0414","\u0434"].includes(n.key)&&(t=t||setInterval((function(){Y(T)}),15))},r=function(e){" "===e.key&&(B(!0),z(!1),U(null))};return Q?(document.addEventListener("keydown",r),function(){document.removeEventListener("keydown",r),n()}):(document.addEventListener("keydown",c),document.addEventListener("keyup",n),function(){document.removeEventListener("keydown",c),document.removeEventListener("keyup",n)})}),[A,Q]),Object(c.useEffect)((function(){if(A&&!H){var e=setInterval((function(){p((function(e){var t=e.ballX,n=e.ballY,c=e.ballStepX,r=e.ballStepY;return{ballX:t+c,ballY:n+r,ballStepX:t+c>=100||t+c<=0?-c:c,ballStepY:n+r>=100||n+r<=0?-r:r}}))}),40);return function(){clearInterval(e)}}}),[H,A]),Object(c.useEffect)((function(){var e=s.ballX,t=s.ballY;0===e?(t+I<=S||t-I>=S)&&h((function(e){return Object(o.a)(Object(o.a)({},e),{},{secondPlayerScore:e.secondPlayerScore+1})})):100===e&&(t+I<=X||t-I>=X)&&h((function(e){return Object(o.a)(Object(o.a)({},e),{},{firstPlayerScore:e.firstPlayerScore+1})}))}),[s,S,X]),Object(c.useEffect)((function(){10===m.firstPlayerScore||10===m.secondPlayerScore?(h(C),g(50),Y(50),U(m.firstPlayerScore>m.secondPlayerScore?t:n),p(Object(o.a)(Object(o.a)({},P),{},{ballStepX:_([-2,2]),ballStepY:_([-1,1])})),B(!1)):0===m.firstPlayerScore&&0===m.secondPlayerScore||(p(Object(o.a)(Object(o.a)({},P),{},{ballStepX:_([-2,2]),ballStepY:_([-1,1])})),z(!0),setTimeout((function(){return z(!1)}),1e3))}),[m,t,n]),""==t||""==n?Object(b.jsx)(i.a,{to:"/"}):Object(b.jsxs)("div",{className:"page-wrapper",children:[Object(b.jsxs)("label",{className:"label-enable-camera",children:["Enable camera:",Object(b.jsx)("input",{type:"checkbox",checked:Q,onClick:function(){return V(!Q)}})]}),Q&&Object(b.jsx)(w,{onSetPlayer1Coord:g,onSetPlayer2Coord:Y}),!A&&Object(b.jsx)(y,{winner:R||""}),Object(b.jsx)(u.b,{to:"/",children:Object(b.jsx)("button",{className:"button-close-game",children:"Close game"})}),Object(b.jsx)("h1",{className:"header-text",children:"Pokemons ping-pong"}),Object(b.jsx)(x,{firstPlayer:t,secondPlayer:n,firstPlayerScore:m.firstPlayerScore,secondPlayerScore:m.secondPlayerScore}),Object(b.jsxs)("div",{className:"ui-field",children:[Object(b.jsx)("div",{className:"dotted-line"}),Object(b.jsx)("div",{className:"game-field",children:Object(b.jsx)(j,{x:s.ballX,y:s.ballY})}),Object(b.jsx)(v,{y:S,pokemonName:t,playerCardType:"left"}),Object(b.jsx)(v,{y:X,pokemonName:n,playerCardType:"right"})]}),Object(b.jsx)("button",{className:"button-start-game ".concat(A?"":"button-visible"),onClick:function(){B(!0),z(!1),U(null)},children:"Start Game"})]})}n(296);var M=n(15);function G(e){var t=e.name,n=e.onClick,c=e.isSelected,r=h(t),a=r.isLoading,s=r.pokemon;return a||!s?Object(b.jsx)("div",{className:"card-wrapper",children:Object(b.jsx)(O.BallSpinner,{size:200,color:"#f8b195"})}):Object(b.jsxs)("div",{className:"card-wrapper ".concat(c?"selected":""),onClick:n,children:[Object(b.jsxs)("span",{className:"block-span",children:["Name: ",s.name]}),Object(b.jsxs)("span",{className:"block-span",children:["Height: ",s.height]}),Object(b.jsxs)("span",{className:"block-span",children:["Weight: ",s.weight]}),Object(b.jsxs)("span",{className:"block-span",children:["Base experience: ",s.base_experience]}),Object(b.jsx)("img",{className:"pokemon-image",src:s.sprites.other.dream_world.front_default})]})}var A=n(33);function B(e){return W.apply(this,arguments)}function W(){return(W=Object(f.a)(d.a.mark((function e(t){var n,c,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://pokeapi.co/api/v2/pokemon?offset=".concat(t*H,"&limit=").concat(H));case 3:return n=e.sent,e.next=6,n.json();case 6:if(c=e.sent,!function(e){return"object"===typeof e&&null!==e&&"count"in e&&"results"in e}(c)){e.next=11;break}return r={count:c.count,results:c.results},e.abrupt("return",r);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:throw new Error("Can't fetch page ".concat(t));case 17:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}var F=function(){var e=Object(f.a)(d.a.mark((function e(t,n,r,a,s){var o,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(c.useEffect)((function(){var e=new Array(r-a.length).fill(a.length).map((function(e,t){return e+t}));s(e)}),[r,a,s]),e.prev=1,o=t.map(function(){var e=Object(f.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B(t);case 2:return n=e.sent,e.abrupt("return",{pageNumber:t,pokemons:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=5,Promise.all(o);case 5:if(l=e.sent,0!==t.length){e.next=8;break}return e.abrupt("return");case 8:n((function(e){var t,n=Object(M.a)(e),c=Object(A.a)(l);try{for(c.s();!(t=c.n()).done;){var r=t.value,a=r.pokemons,s=r.pageNumber;n[s]?n[s]=a:n.push(a)}}catch(o){c.e(o)}finally{c.f()}return n})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log({e:e.t0});case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,n,c,r,a){return e.apply(this,arguments)}}(),H=10,z=Math.floor((Math.round(window.innerHeight/300)+1)/H)+1;function D(e){var t,n=e.selectedPokemons,r=e.onChange,a=Object(c.useState)(z),s=Object(l.a)(a,2),o=s[0],i=s[1],u=Object(c.useState)([]),j=Object(l.a)(u,2),p=j[0],d=j[1],f=Object(c.useState)([]),m=Object(l.a)(f,2),h=m[0],O=m[1],v=Object(c.useRef)(null);!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Object(c.useState)(),a=Object(l.a)(r,2),s=a[0],o=a[1];Object(c.useEffect)((function(){var t=null===e||void 0===e?void 0:e.current;if(t){var c=new IntersectionObserver((function(e){var t=Object(l.a)(e,1)[0];return o(t)}),{threshold:n});return c.observe(t),function(){return c.disconnect()}}}),[e,n]),Object(c.useEffect)((function(){(null===s||void 0===s?void 0:s.isIntersecting)&&t()}),[null===s||void 0===s?void 0:s.isIntersecting,t])}(v,Object(c.useCallback)((function(){i((function(e){return e+1}))}),[]),0),F(p,O,o,h,d);var x=h.flatMap((function(e){return e.results})).map((function(e){var t=e.name;return Object(b.jsx)(G,{name:t,isSelected:n.includes(t),onClick:function(){return function(e){var t=n.indexOf(e),c=Object(M.a)(n);t>-1?c.splice(t,1):(c.push(e),c.length>2&&c.shift()),r(c)}(t)}},t)}));return h.length*H<(null===(t=h[0])||void 0===t?void 0:t.count)||void 0===h[0]?Object(b.jsxs)("div",{className:"pokemon-list-wrapper",children:[x,Object(b.jsx)("div",{ref:v,className:"bottom-ref-element"})]}):Object(b.jsx)("div",{className:"pokemon-list-wrapper",children:x})}function J(e){var t=e.selectedPokemons,n=e.onChangePokemons;return Object(b.jsxs)("div",{className:"page-wrapper",children:[Object(b.jsx)("h1",{className:"header-text",children:"Choose two pokemons"}),Object(b.jsx)(D,{selectedPokemons:t,onChange:n}),Object(b.jsx)(u.b,{to:"/game/".concat(t[0],"/").concat(t[1]),children:Object(b.jsx)("button",{className:"button-start-game ".concat(2!==t.length||t.includes("")?"":"button-visible"),children:"Start Game"})})]})}function R(){var e=Object(c.useState)(["",""]),t=Object(l.a)(e,2),n=t[0],r=t[1];return Object(b.jsx)("div",{className:"App",children:Object(b.jsx)(u.a,{children:Object(b.jsxs)(i.d,{children:[Object(b.jsx)(i.b,{exact:!0,path:"/game/:pokemonOne/:pokemonTwo",render:function(e){var t=e.match;return Object(b.jsx)(Y,Object(o.a)({},t.params))}}),Object(b.jsx)(i.b,{path:"/",render:function(){return Object(b.jsx)(J,{selectedPokemons:n,onChangePokemons:r})}})]})})})}var U=function(){var e=Object(f.a)(d.a.mark((function e(t){var c,r,a,s,o,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&t instanceof Function)){e.next=14;break}return e.next=3,n.e(3).then(n.bind(null,300));case 3:c=e.sent,r=c.getCLS,a=c.getFID,s=c.getFCP,o=c.getLCP,l=c.getTTFB,r(t),a(t),s(t),o(t),l(t);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();s.a.render(Object(b.jsx)(r.a.StrictMode,{children:Object(b.jsx)(R,{})}),document.getElementById("root")),U()}},[[298,1,2]]]);
//# sourceMappingURL=main.9c46532e.chunk.js.map